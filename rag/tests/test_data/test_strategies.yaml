# Test configuration for CLI testing - NEW RAG SCHEMA FORMAT
version: v1

name: minimal_config
namespace: test

models:
  - provider: "local"
    model: "llama3.1:8b"

datasets:
  - name: "minimal_dataset"
    files: []
    data_processing_strategy: "default"
    database: "minimal_db"

prompts:
  - role: "system"
    content: "This is a minimal prompt."

runtime:
  provider: "openai"
  model: "llama3.1:8b"
  api_key: "ollama"
  base_url: "http://localhost:11434/v1"

rag:
  # ==============================================================================
  # TEST DATABASE CONFIGURATION
  # ==============================================================================
  databases:
    - name: "test_db"
      type: "ChromaStore"
      config:
        persist_directory: "./vectordb/test_cli_collection"
        distance_function: "cosine"
        collection_name: "test_cli_collection"
      default_embedding_strategy: "test_embeddings"
      default_retrieval_strategy: "test_similarity"
      embedding_strategies:
        - name: "test_embeddings"
          type: "OllamaEmbedder"
          config:
            model: "nomic-embed-text"
            base_url: "http://localhost:11434"
            batch_size: 4
            timeout: 30
      retrieval_strategies:
        - name: "test_similarity"
          type: "BasicSimilarityStrategy"
          config:
            distance_metric: "cosine"
            top_k: 5
            score_threshold: 0.0

    - name: "quicktest_db"
      type: "ChromaStore"
      config:
        persist_directory: "./vectordb/quicktest"
        distance_function: "cosine"
        collection_name: "quicktest"
      default_embedding_strategy: "quick_embeddings"
      default_retrieval_strategy: "quick_similarity"
      embedding_strategies:
        - name: "quick_embeddings"
          type: "OllamaEmbedder"
          config:
            model: "nomic-embed-text"
            batch_size: 8
      retrieval_strategies:
        - name: "quick_similarity"
          type: "BasicSimilarityStrategy"
          config:
            distance_metric: "cosine"
            top_k: 3

  # ==============================================================================
  # TEST DATA PROCESSING STRATEGIES
  # ==============================================================================
  data_processing_strategies:
    - name: "test_cli_strategy"
      description: "Test strategy for automated CLI testing and verification"
      parsers:
        - type: "TextParser_Python" # Changed from DirectoryParser
          config:
            recursive: false
            file_extensions: [".txt", ".md"]
            encoding: "utf-8"
            ignore_patterns: ["*.pyc", "__pycache__"]
      extractors:
        - type: "KeywordExtractor"
          priority: 100
          config:
            algorithm: "yake"
            max_keywords: 10
            min_keyword_length: 3
            language: "english"
        - type: "ContentStatisticsExtractor"
          priority: 90
          config:
            include_readability: true
            include_vocabulary: true
            include_structure: true

    - name: "quick_test"
      description: "Minimal configuration for quick testing"
      parsers:
        - type: "TextParser_Python"
          config:
            chunk_size: 500
            chunk_overlap: 50
      extractors: [] # No extractors for quick testing
